{
  "name": "lynx_refund_with_trigger_example",
  "description": "Scenariusz refund z użyciem zmiennych szablonowych z triggera",
  "version": "1.0.0",
  "priority": 50,
  "trigger": {
    "type": "manual",
    "description": "Ręczne uruchomienie z danymi z triggera"
  },
  "actions": [
    {
      "type": "log",
      "message": "Rozpoczynam refund dla transakcji {{ trigger.transaction_id }}",
      "level": "info"
    },
    {
      "type": "lynx_refund",
      "component": "lynx_api",
      "transaction_id": "{{ trigger.transaction_id }}",
      "refund_amount": 0,
      "refund_reason": "Auto refund - {{ trigger.error_message }}",
      "refund_email_list": "{{ trigger.admin_email }}"
    },
    {
      "type": "log",
      "message": "Refund request wysłane, rozpoczynam approve",
      "level": "info"
    },
    {
      "type": "lynx_refund_approve",
      "component": "lynx_api",
      "transaction_id": "{{ trigger.transaction_id }}",
      "is_refunded_externally": false,
      "refund_document_url": "{{ trigger.refund_document_url }}",
      "machine_au_time": "{{ trigger.machine_au_time }}"
    },
    {
      "type": "log",
      "message": "Refund approve dla transakcji {{ trigger.transaction_id }} zakończone pomyślnie",
      "level": "success"
    }
  ]
}
