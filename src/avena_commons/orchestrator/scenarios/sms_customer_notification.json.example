{
  "name": "Powiadomienia SMS dla klient√≥w",
  "description": "Automatyczny scenariusz wysy≈ÇajƒÖcy SMS-y do klient√≥w z powiadomieniami o zam√≥wieniach",
  "version": "1.0",
  "author": "System",
  "priority": 70,
  "cooldown": 600,
  "trigger": {
    "type": "automatic",
    "description": "Uruchomienie gdy istniejƒÖ zam√≥wienia wymagajƒÖce powiadomienia SMS",
    "conditions": {
      "database_list": {
        "component": "main_database",
        "table": "aps_orders",
        "columns": [
          "id",
          "aps_id",
          "origin",
          "status",
          "pickup_number",
          "kds_order_number",
          "client_phone_number",
          "estimated_time",
          "created_at",
          "updated_at"
        ],
        "where": {
          "status": "order_processing_has_started",
          "client_phone_number": "IS NOT NULL"
        },
        "result_key": "klienci_do_powiadomienia",
        "limit": 100,
        "order_by": "created_at ASC"
      }
    }
  },
  "actions": [
    {
      "type": "log_event",
      "level": "info",
      "message": "üì± Rozpoczynam wysy≈Çkƒô powiadomie≈Ñ SMS - znaleziono {{ trigger.klienci_do_powiadomienia|length }} klient√≥w",
      "description": "Informacja o rozpoczƒôciu procesu wysy≈Çki SMS"
    },
    {
      "type": "send_sms_to_customer",
      "description": "Wysy≈Çka powiadomie≈Ñ SMS do klient√≥w",
      "phone_field": "client_phone_number",
      "text": "Twoje zam√≥wienie nr {{ pickup_number }} jest gotowe do odbioru (APS ID: {{ aps_id }}). Pozdrawiamy, Zesp√≥≈Ç Avena.",
      "ignore_errors": false
    },
    {
      "type": "log_event",
      "level": "success",
      "message": "‚úÖ Zako≈Ñczono wysy≈Çkƒô powiadomie≈Ñ SMS do klient√≥w",
      "description": "Potwierdzenie wys≈Çania powiadomie≈Ñ SMS"
    },
    {
      "type": "aps_database_update",
      "description": "Oznaczenie zam√≥wie≈Ñ jako powiadomione",
      "component": "main_database",
      "table": "orders",
      "update_column": "status",
      "update_value": "sms_sent",
      "where_column": "status",
      "where_value": "order_processing_has_started"
    }
  ]
}
